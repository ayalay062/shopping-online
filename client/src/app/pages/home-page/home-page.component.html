<div class="bg">
    <div class="shopping-bag-wrapper">


        <div *ngIf="user$ | async; let user">
            <div *ngIf="user && user.role !== 'admin'; else adminBlock">
                <div *ngIf="bag$ | async; let bag; else: orderBlock">
                    <h3>You have open cart from {{ bag.date | date }}</h3>

                    <app-shopping-bag [disChanges]="false"></app-shopping-bag>
                </div>
                <ng-template #orderBlock>
                    <div *ngIf="order$ | async; let order; else: welcome">
                        <h3>Your last purchase was on {{ order.deliveryDate | date }}</h3>
                    </div>
                </ng-template>
                <ng-template #welcome>
                    <div>Welcome to your first shopping!</div>
                </ng-template>

                <a routerLink="/products" *ngIf="bag$ | async; else elseBlock">Continue shopping</a
        >
        <ng-template #elseBlock
          ><a routerLink="/products">Start shopping</a></ng-template>
            </div>
        </div>
        <ng-template #adminBlock>
            <a routerLink="/products">Manage products</a>
        </ng-template>

        <app-home-details *ngIf="user$ | async as user" [id]="user._id ? user._id : 'guest'"></app-home-details>
    </div>
</div>
<div class="bg-after"></div>